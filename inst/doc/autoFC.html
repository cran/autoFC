<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mengtong Li, Tianjun Sun, Bo Zhang" />


<title>autoFC: An R Package for Automatic Item Pairing in Forced-Choice Test Construction</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">autoFC: An R Package for Automatic Item Pairing in Forced-Choice Test Construction</h1>
<h4 class="author">Mengtong Li, Tianjun Sun, Bo Zhang</h4>


<div id="TOC">
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#functions">Functions</a></li>
<li><a href="#tutorial">Tutorial</a>
<ul>
<li><a href="#step-1-input-data">Step 1: Input data</a></li>
<li><a href="#step-2-construct-an-initial-solution">Step 2: Construct an initial solution</a></li>
<li><a href="#step-3-calculate-the-energy-for-the-initial-fc-scale-without-and-with-iias">Step 3: Calculate the energy for the initial FC scale, without and with IIAs</a></li>
<li><a href="#step-4-automatic-pairing">Step 4: Automatic pairing</a></li>
<li><a href="#step-5-see-how-this-improves-over-the-initial-one">Step 5: See how this improves over the initial one</a></li>
<li><a href="#step-6-automatic-pairing-with-a-multi-step-optimization-process">Step 6: Automatic pairing with a multi-step optimization process</a></li>
<li><a href="#step-7-see-how-a-multi-step-iteration-improves">Step 7: See how a multi-step iteration improves</a></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
</div>

<div id="overview" class="section level2">
<h2>Overview</h2>
<p>Forced-choice (<strong>FC</strong>) tests are gaining researcher’s interest increasingly for its faking resistance when well-designed. Well-designed FC tests should often be characterized by <em>items within a block measuring different latent traits</em>, and <em>items within a block having similar magnitude, or high inter-item agreement <strong>(IIA)</strong> in terms of their social desirability</em>. Other scoring models may also require <em>factor loading differences or item locations within a block to be maximized or minimized</em>.</p>
<p>Either way, decision on which items should be assigned to the same block - item pairing - is a crucial issue in building a well-designed FC test, which is currently carried out manually. However, given that we often need to simultaneously meet multiple objectives, manual pairing will turn out to be impractical and even infeasible, especially when the number of latent traits and/or the number of items per trait become relatively large.</p>
<p>The R package <strong>autoFC</strong> is developed to address these difficulties and provides a tool for facilitating automatic FC test construction. It offers users the functionality to:</p>
<ol style="list-style-type: decimal">
<li><p>Customize one or more item pairing criteria and calculate a composite pairing index, termed <strong>“energy”</strong> with user-specified weights for each criterion.</p></li>
<li><p>Automatically optimize the energy for the whole test by sequentially or simultaneously optimizing each matching rule, through the exchange of items among blocks or replacement with unused items.</p></li>
<li><p>Construct parallel forms of the same test following the same pairing rules.</p></li>
</ol>
<p>Users are allowed to create an FC test of any block size (e.g. Pairs, Triplets, Quadruplets).</p>
</div>
<div id="functions" class="section level2">
<h2>Functions</h2>
<p>Below is a brief explanation of all functions provided by <strong>autoFC</strong>. Details and usage can be found in the next section.</p>
<ol style="list-style-type: decimal">
<li><code>cal_block_energy()</code> and <code>cal_block_energy_with_iia()</code> both calculate the total energy for a single item block, or a full FC test with multiple blocks, given a data frame of item characteristics. The latter function incorporates IIA metrics into energy calculation.</li>
</ol>
<ul>
<li>By default, numeric item characteristics are paired by minimizing variance within each block, and factor item characteristics are paired such that it’s more preferable for items in the same block to be from different factor levels. Each characteristic has a default weight of 1.</li>
<li>In addition, <code>cal_block_energy_with_iia()</code> incorporates four IIA metrics in which items are paired by maximizing the IIA within each block. Each IIA has a default weight of 1.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li><p><code>make_random_block()</code> takes in number of items and block size as input arguments and produces a test with blocks of randomly paired item numbers. Information about item characteristics is not required.</p></li>
<li><p><code>get_iia()</code> takes in item responses and a single item block (Or a full FC test with multiple blocks), then returns IIA metrics for each item block.</p></li>
<li><p><code>sa_pairing_generalized()</code> is the automatic pairing function which takes in item characteristics (and also individual responses for all items) and an initial FC test, then optimizes the energy of the test based on Simulated Annealing (SA) algorithm.</p></li>
</ol>
<ul>
<li><p>SA is a probabilistic technique for approximating the global optimum of a given function, in which each iteration involves the cool down of the “Temperature” until it reaches a certain value. Within each iteration, a new solution (<strong>FC test</strong>) is produced and compared with current solution in terms of their energy (Which is calculated by calling <code>cal_block_energy()</code> or <code>cal_block_energy_with_iia()</code>. Acceptance or rejection of new solution is determined as follows:</p>
<ul>
<li>Better solution (An FC test with higher energy) is always accepted and updated into the new current solution.</li>
<li>Worse solution (An FC test with lower energy) is conditionally accepted, determined by the current temperature and the deviation of new solution’s energy from the current one’s. A worse solution is more likely to be accepted when temperature is high and when the deviance is relatively small.</li>
</ul></li>
<li><p>If all items in the item characteristic data frame are used to construct the FC test, <code>sa_pairing_generalized()</code> will produce new solutions by randomly exchanging items between two blocks; Otherwise, it will randomly select between exchanging items and replacing with unused items based on proportion of items used to construct the test.</p></li>
<li><p><code>sa_pairing_generalized()</code> has built-in default values for most of the arguments if they are not given; For example, an FC test with block size 2 using all of the given items will be constructed by default if the <code>block</code> argument is not provided. See the tutorial below for meanings and default values for other arguments.</p></li>
</ul>
</div>
<div id="tutorial" class="section level2">
<h2>Tutorial</h2>
<div id="step-1-input-data" class="section level3">
<h3>Step 1: Input data</h3>
<p>In this tutorial, we suppose that 60 5-Point Likert items measuring Big Five traits, each with a certain item location, are used to build a FC scale with block size 3. We also simulate responses from 1,000 participants for the 60 items on their social desirability.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulation of 1,000 respondents on 60 items. A better simulation should be</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># consisting of responses produced by specific IRT parameters.</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="dv">500</span><span class="sc">*</span><span class="dv">60</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.10</span>, <span class="fl">0.15</span>, <span class="fl">0.20</span>, <span class="fl">0.25</span>, <span class="fl">0.30</span>))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="dv">500</span><span class="sc">*</span><span class="dv">60</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.50</span>, <span class="fl">0.10</span>, <span class="fl">0.10</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>))</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>item_responses <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(s1, s2), <span class="at">ncol =</span> <span class="dv">60</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>item_dims <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">&quot;Openness&quot;</span>,<span class="st">&quot;Conscientiousness&quot;</span>,<span class="st">&quot;Neuroticism&quot;</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;Extraversion&quot;</span>,<span class="st">&quot;Agreeableness&quot;</span>), <span class="dv">60</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>item_mean <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(item_responses)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>item_difficulty <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">60</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we build a data frame with item characteristics</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>item_chars <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">DIM =</span> item_dims, <span class="at">SD_Mean =</span> item_mean, <span class="at">DIFF =</span> item_difficulty)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>char_weights <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">3</span>)</span></code></pre></div>
</div>
<div id="step-2-construct-an-initial-solution" class="section level3">
<h3>Step 2: Construct an initial solution</h3>
<p>Next, we build a random FC scale using the 60 items with block size 3. You can see from <code>initial_FC</code> that now all 60 items are divided into 20 triplets.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>initial_FC <span class="ot">&lt;-</span> <span class="fu">make_random_block</span>(<span class="at">total_items =</span> <span class="dv">60</span>, <span class="at">item_per_block =</span> <span class="dv">3</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(initial_FC)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">59</td>
<td align="right">14</td>
<td align="right">43</td>
</tr>
<tr class="even">
<td align="right">42</td>
<td align="right">16</td>
<td align="right">34</td>
</tr>
<tr class="odd">
<td align="right">41</td>
<td align="right">60</td>
<td align="right">22</td>
</tr>
<tr class="even">
<td align="right">26</td>
<td align="right">19</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">28</td>
<td align="right">10</td>
<td align="right">45</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">52</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="right">35</td>
<td align="right">1</td>
<td align="right">51</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">49</td>
<td align="right">33</td>
</tr>
<tr class="odd">
<td align="right">40</td>
<td align="right">7</td>
<td align="right">57</td>
</tr>
<tr class="even">
<td align="right">55</td>
<td align="right">54</td>
<td align="right">18</td>
</tr>
<tr class="odd">
<td align="right">38</td>
<td align="right">5</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">31</td>
<td align="right">11</td>
<td align="right">39</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">3</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">32</td>
<td align="right">58</td>
<td align="right">48</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">29</td>
<td align="right">47</td>
</tr>
<tr class="even">
<td align="right">27</td>
<td align="right">20</td>
<td align="right">56</td>
</tr>
<tr class="odd">
<td align="right">24</td>
<td align="right">9</td>
<td align="right">30</td>
</tr>
<tr class="even">
<td align="right">44</td>
<td align="right">21</td>
<td align="right">46</td>
</tr>
<tr class="odd">
<td align="right">53</td>
<td align="right">17</td>
<td align="right">25</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">36</td>
<td align="right">37</td>
</tr>
</tbody>
</table>
<p>Also let’s see the how the item characteristics look like for each of the 20 triplets.</p>
<p>First, the underlying latent traits. We see that there are some cases where two items measuring the same traits appear in the same block, which is something we want to avoid.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">matrix</span>(item_chars<span class="sc">$</span>DIM[<span class="fu">t</span>(initial_FC)], <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">Conscientiousness</td>
<td align="left">Conscientiousness</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Extraversion</td>
<td align="left">Openness</td>
<td align="left">Agreeableness</td>
</tr>
<tr class="odd">
<td align="left">Openness</td>
<td align="left">Conscientiousness</td>
<td align="left">Openness</td>
</tr>
<tr class="even">
<td align="left">Conscientiousness</td>
<td align="left">Extraversion</td>
<td align="left">Openness</td>
</tr>
<tr class="odd">
<td align="left">Neuroticism</td>
<td align="left">Extraversion</td>
<td align="left">Extraversion</td>
</tr>
<tr class="even">
<td align="left">Openness</td>
<td align="left">Openness</td>
<td align="left">Conscientiousness</td>
</tr>
<tr class="odd">
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
<td align="left">Agreeableness</td>
</tr>
<tr class="even">
<td align="left">Openness</td>
<td align="left">Extraversion</td>
<td align="left">Extraversion</td>
</tr>
<tr class="odd">
<td align="left">Extraversion</td>
<td align="left">Conscientiousness</td>
<td align="left">Extraversion</td>
</tr>
<tr class="even">
<td align="left">Openness</td>
<td align="left">Agreeableness</td>
<td align="left">Extraversion</td>
</tr>
<tr class="odd">
<td align="left">Neuroticism</td>
<td align="left">Neuroticism</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Extraversion</td>
<td align="left">Conscientiousness</td>
<td align="left">Openness</td>
</tr>
<tr class="odd">
<td align="left">Neuroticism</td>
<td align="left">Conscientiousness</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Extraversion</td>
<td align="left">Extraversion</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="odd">
<td align="left">Openness</td>
<td align="left">Openness</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Neuroticism</td>
<td align="left">Conscientiousness</td>
<td align="left">Conscientiousness</td>
</tr>
<tr class="odd">
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Agreeableness</td>
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
</tr>
<tr class="odd">
<td align="left">Conscientiousness</td>
<td align="left">Conscientiousness</td>
<td align="left">Agreeableness</td>
</tr>
<tr class="even">
<td align="left">Neuroticism</td>
<td align="left">Extraversion</td>
<td align="left">Openness</td>
</tr>
</tbody>
</table>
<p>Then, scores on social desirability. We do see many cases where items differ in their social desirability on a magnitude of &gt;1 on a 5-point scale, within a block. That’s not good.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sd_initial <span class="ot">&lt;-</span> <span class="fu">matrix</span>(item_chars<span class="sc">$</span>SD_Mean[<span class="fu">t</span>(initial_FC)], <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(sd_initial)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">2.327</td>
<td align="right">3.549</td>
<td align="right">2.257</td>
</tr>
<tr class="even">
<td align="right">2.269</td>
<td align="right">3.417</td>
<td align="right">2.410</td>
</tr>
<tr class="odd">
<td align="right">2.331</td>
<td align="right">2.386</td>
<td align="right">3.549</td>
</tr>
<tr class="even">
<td align="right">3.575</td>
<td align="right">3.481</td>
<td align="right">3.492</td>
</tr>
<tr class="odd">
<td align="right">3.628</td>
<td align="right">3.469</td>
<td align="right">2.430</td>
</tr>
<tr class="even">
<td align="right">3.470</td>
<td align="right">2.326</td>
<td align="right">3.418</td>
</tr>
<tr class="odd">
<td align="right">2.306</td>
<td align="right">3.518</td>
<td align="right">2.299</td>
</tr>
<tr class="even">
<td align="right">3.455</td>
<td align="right">2.367</td>
<td align="right">2.382</td>
</tr>
<tr class="odd">
<td align="right">2.372</td>
<td align="right">3.429</td>
<td align="right">2.291</td>
</tr>
<tr class="even">
<td align="right">2.383</td>
<td align="right">2.275</td>
<td align="right">3.501</td>
</tr>
<tr class="odd">
<td align="right">2.346</td>
<td align="right">3.499</td>
<td align="right">3.493</td>
</tr>
<tr class="even">
<td align="right">2.371</td>
<td align="right">3.476</td>
<td align="right">2.381</td>
</tr>
<tr class="odd">
<td align="right">3.429</td>
<td align="right">3.540</td>
<td align="right">3.478</td>
</tr>
<tr class="even">
<td align="right">2.375</td>
<td align="right">2.383</td>
<td align="right">2.283</td>
</tr>
<tr class="odd">
<td align="right">3.551</td>
<td align="right">3.484</td>
<td align="right">2.367</td>
</tr>
<tr class="even">
<td align="right">3.458</td>
<td align="right">3.521</td>
<td align="right">2.296</td>
</tr>
<tr class="odd">
<td align="right">3.515</td>
<td align="right">3.474</td>
<td align="right">3.524</td>
</tr>
<tr class="even">
<td align="right">2.275</td>
<td align="right">3.501</td>
<td align="right">2.408</td>
</tr>
<tr class="odd">
<td align="right">2.354</td>
<td align="right">3.526</td>
<td align="right">3.449</td>
</tr>
<tr class="even">
<td align="right">2.314</td>
<td align="right">2.294</td>
<td align="right">2.344</td>
</tr>
</tbody>
</table>
<p>Lastly, item difficulty. We also see that item difficulties within a block are also inconsistent.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>diff_initial <span class="ot">&lt;-</span> <span class="fu">matrix</span>(item_chars<span class="sc">$</span>DIFF[<span class="fu">t</span>(initial_FC)], <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(diff_initial)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">0.5768038</td>
<td align="right">-0.1649317</td>
<td align="right">-0.1609612</td>
</tr>
<tr class="even">
<td align="right">0.7562551</td>
<td align="right">0.3665809</td>
<td align="right">-0.8802425</td>
</tr>
<tr class="odd">
<td align="right">-0.3477869</td>
<td align="right">0.4033506</td>
<td align="right">0.9447096</td>
</tr>
<tr class="even">
<td align="right">0.8602120</td>
<td align="right">-0.5168748</td>
<td align="right">-0.1734361</td>
</tr>
<tr class="odd">
<td align="right">0.3712718</td>
<td align="right">-0.6267511</td>
<td align="right">0.0917744</td>
</tr>
<tr class="even">
<td align="right">-0.9688906</td>
<td align="right">0.9139843</td>
<td align="right">0.3986206</td>
</tr>
<tr class="odd">
<td align="right">0.2507761</td>
<td align="right">-0.0490111</td>
<td align="right">-0.5887666</td>
</tr>
<tr class="even">
<td align="right">-0.1364442</td>
<td align="right">0.7372855</td>
<td align="right">0.2383125</td>
</tr>
<tr class="odd">
<td align="right">0.6598719</td>
<td align="right">0.5910397</td>
<td align="right">0.3847467</td>
</tr>
<tr class="even">
<td align="right">0.1906729</td>
<td align="right">-0.1072381</td>
<td align="right">-0.2764722</td>
</tr>
<tr class="odd">
<td align="right">0.8652686</td>
<td align="right">0.3189794</td>
<td align="right">-0.7635046</td>
</tr>
<tr class="even">
<td align="right">-0.8770999</td>
<td align="right">0.5814682</td>
<td align="right">0.7113918</td>
</tr>
<tr class="odd">
<td align="right">0.9814553</td>
<td align="right">-0.0455446</td>
<td align="right">0.6105311</td>
</tr>
<tr class="even">
<td align="right">-0.7874764</td>
<td align="right">-0.1775934</td>
<td align="right">-0.2743858</td>
</tr>
<tr class="odd">
<td align="right">0.5481408</td>
<td align="right">-0.1896666</td>
<td align="right">-0.7339903</td>
</tr>
<tr class="even">
<td align="right">-0.7614264</td>
<td align="right">0.6233055</td>
<td align="right">0.2106074</td>
</tr>
<tr class="odd">
<td align="right">-0.4487723</td>
<td align="right">0.9388348</td>
<td align="right">-0.7846000</td>
</tr>
<tr class="even">
<td align="right">0.8782261</td>
<td align="right">-0.9898177</td>
<td align="right">0.0105288</td>
</tr>
<tr class="odd">
<td align="right">0.4304538</td>
<td align="right">0.3800486</td>
<td align="right">-0.4484543</td>
</tr>
<tr class="even">
<td align="right">0.9194196</td>
<td align="right">0.8647261</td>
<td align="right">-0.0951617</td>
</tr>
</tbody>
</table>
</div>
<div id="step-3-calculate-the-energy-for-the-initial-fc-scale-without-and-with-iias" class="section level3">
<h3>Step 3: Calculate the energy for the initial FC scale, without and with IIAs</h3>
<p>Next we calculate the energy for <code>initial_FC</code>, with <code>FUN</code> set to be default. <code>weights</code> is set to -1 for social desirability and -3 for item difficulty because we want the discrepancy of these characteristics to be as low as possible within a block.</p>
<p>The weight for item difficulty is higher to scale for its smaller range than social desirability. Beware about the scaling difference among different item characteristics and use different weights accordingly.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cal_block_energy</span>(<span class="at">block =</span> initial_FC, <span class="at">item_chars =</span> item_chars, <span class="at">weights =</span> char_weights)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -25.28441</span></span></code></pre></div>
<p>If IIAs are to be involved we have lower energy value. This is because these randomly generated responses are not likely to be consistent with each other, hence very low and even negative IIAs:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cal_block_energy_with_iia</span>(<span class="at">block =</span> initial_FC, <span class="at">item_chars =</span> item_chars, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weights =</span> char_weights,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">rater_chars =</span> item_responses)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           [,1]</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] -33.31589</span></span></code></pre></div>
<p>Notice that if we give zero weights to all IIAs we will get the same energy value as <code>cal_block_energy</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cal_block_energy_with_iia</span>(<span class="at">block =</span> initial_FC, <span class="at">item_chars =</span> item_chars, </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weights =</span> char_weights,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">rater_chars =</span> item_responses, </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">iia_weights =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           [,1]</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] -25.28441</span></span></code></pre></div>
<p>Also, if you want to see the inter-item agreement metrics for each block, you can use <code>get_iia()</code>. It should not be too impressive and is for demonstration purposes only. Users are suggested to use real world response data to see the IIA within each block.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">get_iia</span>(<span class="at">block =</span> initial_FC, <span class="at">data =</span> item_responses))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">BPlin</th>
<th align="right">BPquad</th>
<th align="right">AClin</th>
<th align="right">ACquad</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.17500</td>
<td align="right">-0.38133</td>
<td align="right">-0.07767</td>
<td align="right">-0.17000</td>
</tr>
<tr class="even">
<td align="right">-0.11958</td>
<td align="right">-0.27900</td>
<td align="right">-0.03922</td>
<td align="right">-0.10768</td>
</tr>
<tr class="odd">
<td align="right">-0.17125</td>
<td align="right">-0.35733</td>
<td align="right">-0.09333</td>
<td align="right">-0.18799</td>
</tr>
<tr class="even">
<td align="right">0.09583</td>
<td align="right">0.14883</td>
<td align="right">0.13905</td>
<td align="right">0.22648</td>
</tr>
<tr class="odd">
<td align="right">-0.10458</td>
<td align="right">-0.20183</td>
<td align="right">-0.08040</td>
<td align="right">-0.15034</td>
</tr>
<tr class="even">
<td align="right">-0.09542</td>
<td align="right">-0.18250</td>
<td align="right">-0.08069</td>
<td align="right">-0.15112</td>
</tr>
<tr class="odd">
<td align="right">-0.15000</td>
<td align="right">-0.31867</td>
<td align="right">-0.06953</td>
<td align="right">-0.14620</td>
</tr>
<tr class="even">
<td align="right">-0.14583</td>
<td align="right">-0.30900</td>
<td align="right">-0.08054</td>
<td align="right">-0.16786</td>
</tr>
<tr class="odd">
<td align="right">-0.13167</td>
<td align="right">-0.29967</td>
<td align="right">-0.04673</td>
<td align="right">-0.11820</td>
</tr>
<tr class="even">
<td align="right">-0.14208</td>
<td align="right">-0.33417</td>
<td align="right">-0.05416</td>
<td align="right">-0.14343</td>
</tr>
<tr class="odd">
<td align="right">-0.11500</td>
<td align="right">-0.21550</td>
<td align="right">-0.09354</td>
<td align="right">-0.16960</td>
</tr>
<tr class="even">
<td align="right">-0.18083</td>
<td align="right">-0.36500</td>
<td align="right">-0.09805</td>
<td align="right">-0.18615</td>
</tr>
<tr class="odd">
<td align="right">0.07375</td>
<td align="right">0.10000</td>
<td align="right">0.11266</td>
<td align="right">0.17256</td>
</tr>
<tr class="even">
<td align="right">-0.03125</td>
<td align="right">-0.19833</td>
<td align="right">0.14874</td>
<td align="right">0.15781</td>
</tr>
<tr class="odd">
<td align="right">-0.12875</td>
<td align="right">-0.26000</td>
<td align="right">-0.09955</td>
<td align="right">-0.19646</td>
</tr>
<tr class="even">
<td align="right">-0.12708</td>
<td align="right">-0.22517</td>
<td align="right">-0.11082</td>
<td align="right">-0.19031</td>
</tr>
<tr class="odd">
<td align="right">0.11208</td>
<td align="right">0.16633</td>
<td align="right">0.15302</td>
<td align="right">0.23982</td>
</tr>
<tr class="even">
<td align="right">-0.15458</td>
<td align="right">-0.32067</td>
<td align="right">-0.07820</td>
<td align="right">-0.15677</td>
</tr>
<tr class="odd">
<td align="right">-0.09208</td>
<td align="right">-0.18267</td>
<td align="right">-0.07283</td>
<td align="right">-0.14170</td>
</tr>
<tr class="even">
<td align="right">-0.05833</td>
<td align="right">-0.26133</td>
<td align="right">0.14720</td>
<td align="right">0.14891</td>
</tr>
</tbody>
</table>
</div>
<div id="step-4-automatic-pairing" class="section level3">
<h3>Step 4: Automatic pairing</h3>
<p>To produce an optimized paired FC scale, we have the objective of:<br />
* <strong>Keeping items in the same block being from different latent traits;</strong><br />
* <strong>Minimizing variance of social desirability within each block;</strong><br />
* <strong>Minimizing variance of item difficulty within each block.</strong></p>
<p>For IIAs, we also want to <strong>maximize the mean of the four IIAs within each block</strong>.</p>
<div id="explanation-for-arguments" class="section level4">
<h4>Explanation for arguments</h4>
<p>Below is an example run of producing an automatically paired FC. Arguments that may be of interest for users include:</p>
<p><code>block</code>: The initial paired FC scale, which can be produced in Step 2. If left empty, an FC scale with block size 2 and items presented sequentially will be produced, with total number of items equals to number of rows in <code>item_chars</code>.</p>
<p><code>total_items</code>: Default to be number of unique values in <code>block</code>. Can be a value larger than this value which represents cases where only some items in the item pool are used to build an FC scale.</p>
<p><code>Temperature</code>: The initial temperature value of the automatic pairing method. Higher temperature is associated with higher probability of accepting a worse solution. It is recommended to leave this value blank and let it be scaled on the energy of <code>block</code> by specifying <code>eta_Temperature</code>.</p>
<p><code>r</code>: Determines the decrease rate of <code>Temperature</code>. Should be a value between 0 and 1. Larger r values allows more iterations in the optimization process but will slow down the program.</p>
<p><code>end_criteria</code>: Determines the end criteria for the automatic pairing process. A proportion value scaled on <code>Temperature</code>. Should be a value between 0 and 1. Smaller values allows more iterations in the optimization process but will slow down the program.</p>
<p><code>item_chars</code>: A data frame with item characteristics for all items. It is recommended that information irrelevant to pairing be discarded beforehand, but users can also set the corresponding position in <code>weights</code> to be 0 to bypass these irrelevant item characteristics (Such is item ID).</p>
<p><code>FUN</code>: A vector of function names for optimizing each item characteristic within each block. For example: <code>FUN = c(&#39;mean&#39;, &#39;var&#39;, &#39;sum&#39;)</code>. Also supports customized functions. Defaults to <code>var</code> for numeric variables and <code>facfun</code> for factor/character variables.</p>
<p><code>n_exchange</code>: Determines how many blocks are exchanged in order to produce a new solution for each iteration. Should be a value less than <code>nrow(block)</code>.</p>
<p><code>weights</code>: A vector of integer values indicating relative weights for each item characteristic after calculated by <code>FUN</code>. Default to be a vector of all 1s.</p>
<p><code>prob_newitem</code>: Probability of choosing the strategy of picking a new item, when not all candidate items are used to build the FC scale.</p>
</div>
<div id="explanation-for-arguments-if-iias-are-of-concern" class="section level4">
<h4>Explanation for arguments (If IIAs are of concern)</h4>
<p>If you wish to use IIAs as pairing criterion, here are some arguments that might be useful. Note that <code>rater_chars</code> and <code>iia_weights</code> are ignored when <code>use_IIA</code> is <code>FALSE</code>.</p>
<p><code>use_IIA</code>: Logical. Indicates whether IIA metrics are used as matching criteria.</p>
<p><code>rater_chars</code>: Item responses for all items by a certain number of participants.</p>
<p><code>iia_weights</code>: A vector of length 4 indicating weights given for the 4 IIA metrics, including linearly and quadratically weighted AC (Gwet, 2008; 2014) and Brennan-Prediger Index (Prennan &amp; Prediger, 1981; Gwet, 2014). Default to a vector of all 1s.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that this will take some time to run! (~ 1-2 minutes with this setting)</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Weights for social desirability score and item difficulty should be set to -1, </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co"># because we don&#39;t want variance for these characteristics to be big.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">sa_pairing_generalized</span>(<span class="at">block =</span> initial_FC, <span class="at">eta_Temperature =</span> <span class="fl">0.01</span>,</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">r =</span> <span class="fl">0.995</span>, <span class="at">end_criteria =</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>), </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">weights =</span> char_weights,</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">item_chars =</span> item_chars, <span class="at">use_IIA =</span> <span class="cn">TRUE</span>,</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">rater_chars =</span> item_responses)</span></code></pre></div>
</div>
</div>
<div id="step-5-see-how-this-improves-over-the-initial-one" class="section level3">
<h3>Step 5: See how this improves over the initial one</h3>
<p>Finally, let’s see how this pairing method improves from the initial solution!</p>
<p>Let’s first see the total energy compared to the previous one. First are the initial energy, which is identical to what we have calculated in Step 4.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial energy with IIA</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cal_block_energy_with_iia</span>(<span class="at">block =</span> result<span class="sc">$</span>block_initial, <span class="at">item_chars =</span> item_chars, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weights =</span> char_weights, <span class="at">rater_chars =</span> item_responses)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           [,1]</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] -33.31589</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative way to calculate initial energy</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>energy_initial)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -33.31589</span></span></code></pre></div>
<p>And the final result:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Final energy with IIA</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cal_block_energy_with_iia</span>(<span class="at">block =</span> result<span class="sc">$</span>block_final, <span class="at">item_chars =</span> item_chars, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">weights =</span> char_weights, <span class="at">rater_chars =</span> item_responses)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          [,1]</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 21.69018</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative way to calculate final energy</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result<span class="sc">$</span>energy_final)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 21.69018</span></span></code></pre></div>
<p>Let’s take a look at how items are matched within each block. First are underlying latent traits.</p>
<p>This time, within each block, the three items are already coming from three distinct latent traits!</p>
<p><strong>(Note: It does not guarantee that items will ALWAYS come from different latent traits after pairing. But if you want to increase the likelihood for such a result, you can increase the weight corresponding to item dimension)</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">matrix</span>(item_chars<span class="sc">$</span>DIM[<span class="fu">t</span>(result<span class="sc">$</span>block_final)], <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
<td align="left">Extraversion</td>
</tr>
<tr class="even">
<td align="left">Extraversion</td>
<td align="left">Neuroticism</td>
<td align="left">Agreeableness</td>
</tr>
<tr class="odd">
<td align="left">Openness</td>
<td align="left">Conscientiousness</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Neuroticism</td>
<td align="left">Extraversion</td>
<td align="left">Conscientiousness</td>
</tr>
<tr class="odd">
<td align="left">Openness</td>
<td align="left">Conscientiousness</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Extraversion</td>
<td align="left">Conscientiousness</td>
<td align="left">Openness</td>
</tr>
<tr class="odd">
<td align="left">Openness</td>
<td align="left">Extraversion</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Conscientiousness</td>
<td align="left">Openness</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="odd">
<td align="left">Openness</td>
<td align="left">Agreeableness</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Agreeableness</td>
<td align="left">Extraversion</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="odd">
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
<td align="left">Extraversion</td>
</tr>
<tr class="even">
<td align="left">Conscientiousness</td>
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
</tr>
<tr class="odd">
<td align="left">Extraversion</td>
<td align="left">Openness</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Conscientiousness</td>
<td align="left">Extraversion</td>
<td align="left">Openness</td>
</tr>
<tr class="odd">
<td align="left">Agreeableness</td>
<td align="left">Extraversion</td>
<td align="left">Conscientiousness</td>
</tr>
<tr class="even">
<td align="left">Neuroticism</td>
<td align="left">Agreeableness</td>
<td align="left">Extraversion</td>
</tr>
<tr class="odd">
<td align="left">Conscientiousness</td>
<td align="left">Extraversion</td>
<td align="left">Openness</td>
</tr>
<tr class="even">
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
<td align="left">Conscientiousness</td>
</tr>
<tr class="odd">
<td align="left">Extraversion</td>
<td align="left">Openness</td>
<td align="left">Conscientiousness</td>
</tr>
<tr class="even">
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
<td align="left">Conscientiousness</td>
</tr>
</tbody>
</table>
<p>Next let’s look at difference in social desirability within each block. Item social desirability scores are much closer to each other within each block, but we see that there are still big discrepancies two blocks.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>sd_final <span class="ot">&lt;-</span> <span class="fu">matrix</span>(item_chars<span class="sc">$</span>SD_Mean[<span class="fu">t</span>(result<span class="sc">$</span>block_final)], <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(sd_final)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">3.493</td>
<td align="right">3.518</td>
<td align="right">3.481</td>
</tr>
<tr class="even">
<td align="right">3.469</td>
<td align="right">3.501</td>
<td align="right">3.449</td>
</tr>
<tr class="odd">
<td align="right">3.549</td>
<td align="right">3.429</td>
<td align="right">3.478</td>
</tr>
<tr class="even">
<td align="right">2.306</td>
<td align="right">2.382</td>
<td align="right">2.354</td>
</tr>
<tr class="odd">
<td align="right">3.417</td>
<td align="right">3.418</td>
<td align="right">3.499</td>
</tr>
<tr class="even">
<td align="right">2.372</td>
<td align="right">2.327</td>
<td align="right">2.383</td>
</tr>
<tr class="odd">
<td align="right">3.470</td>
<td align="right">2.375</td>
<td align="right">3.458</td>
</tr>
<tr class="even">
<td align="right">3.575</td>
<td align="right">3.474</td>
<td align="right">3.429</td>
</tr>
<tr class="odd">
<td align="right">2.344</td>
<td align="right">2.299</td>
<td align="right">2.283</td>
</tr>
<tr class="even">
<td align="right">2.275</td>
<td align="right">2.269</td>
<td align="right">2.314</td>
</tr>
<tr class="odd">
<td align="right">2.346</td>
<td align="right">2.326</td>
<td align="right">2.294</td>
</tr>
<tr class="even">
<td align="right">3.540</td>
<td align="right">3.524</td>
<td align="right">3.492</td>
</tr>
<tr class="odd">
<td align="right">2.383</td>
<td align="right">2.331</td>
<td align="right">2.257</td>
</tr>
<tr class="even">
<td align="right">2.386</td>
<td align="right">2.291</td>
<td align="right">2.408</td>
</tr>
<tr class="odd">
<td align="right">2.275</td>
<td align="right">2.430</td>
<td align="right">2.296</td>
</tr>
<tr class="even">
<td align="right">2.367</td>
<td align="right">2.410</td>
<td align="right">2.371</td>
</tr>
<tr class="odd">
<td align="right">3.476</td>
<td align="right">2.367</td>
<td align="right">2.381</td>
</tr>
<tr class="even">
<td align="right">3.515</td>
<td align="right">3.455</td>
<td align="right">3.526</td>
</tr>
<tr class="odd">
<td align="right">3.501</td>
<td align="right">3.484</td>
<td align="right">3.549</td>
</tr>
<tr class="even">
<td align="right">3.628</td>
<td align="right">3.551</td>
<td align="right">3.521</td>
</tr>
</tbody>
</table>
<p>A more intuitive way to present this: how much have we improved on the average variance for all blocks? Still, it is much lower, but we see there is always space to improve.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(<span class="fu">apply</span>(sd_initial, <span class="dv">1</span>, var)))   </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3317092</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Final</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(<span class="fu">apply</span>(sd_final, <span class="dv">1</span>, var)))     </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.04195382</span></span></code></pre></div>
<p>Finally we look at item difficulty. Good improvement is also observed. We see that difference in item difficulty within a block also decreases:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>diff_final <span class="ot">&lt;-</span> <span class="fu">matrix</span>(item_chars<span class="sc">$</span>DIF[<span class="fu">t</span>(result<span class="sc">$</span>block_final)], <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(diff_final)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">-0.7635046</td>
<td align="right">-0.0490111</td>
<td align="right">-0.5168748</td>
</tr>
<tr class="even">
<td align="right">-0.6267511</td>
<td align="right">-0.9898177</td>
<td align="right">-0.4484543</td>
</tr>
<tr class="odd">
<td align="right">0.9447096</td>
<td align="right">0.5910397</td>
<td align="right">0.6105311</td>
</tr>
<tr class="even">
<td align="right">0.2507761</td>
<td align="right">0.2383125</td>
<td align="right">0.4304538</td>
</tr>
<tr class="odd">
<td align="right">0.3665809</td>
<td align="right">0.3986206</td>
<td align="right">0.3189794</td>
</tr>
<tr class="even">
<td align="right">0.6598719</td>
<td align="right">0.5768038</td>
<td align="right">0.1906729</td>
</tr>
<tr class="odd">
<td align="right">-0.9688906</td>
<td align="right">-0.7874764</td>
<td align="right">-0.7614264</td>
</tr>
<tr class="even">
<td align="right">0.8602120</td>
<td align="right">0.9388348</td>
<td align="right">0.9814553</td>
</tr>
<tr class="odd">
<td align="right">-0.0951617</td>
<td align="right">-0.5887666</td>
<td align="right">-0.2743858</td>
</tr>
<tr class="even">
<td align="right">0.8782261</td>
<td align="right">0.7562551</td>
<td align="right">0.9194196</td>
</tr>
<tr class="odd">
<td align="right">0.8652686</td>
<td align="right">0.9139843</td>
<td align="right">0.8647261</td>
</tr>
<tr class="even">
<td align="right">-0.0455446</td>
<td align="right">-0.7846000</td>
<td align="right">-0.1734361</td>
</tr>
<tr class="odd">
<td align="right">-0.1775934</td>
<td align="right">-0.3477869</td>
<td align="right">-0.1609612</td>
</tr>
<tr class="even">
<td align="right">0.4033506</td>
<td align="right">0.3847467</td>
<td align="right">0.0105288</td>
</tr>
<tr class="odd">
<td align="right">-0.1072381</td>
<td align="right">0.0917744</td>
<td align="right">0.2106074</td>
</tr>
<tr class="even">
<td align="right">-0.7339903</td>
<td align="right">-0.8802425</td>
<td align="right">-0.8770999</td>
</tr>
<tr class="odd">
<td align="right">0.5814682</td>
<td align="right">0.7372855</td>
<td align="right">0.7113918</td>
</tr>
<tr class="even">
<td align="right">-0.4487723</td>
<td align="right">-0.1364442</td>
<td align="right">0.3800486</td>
</tr>
<tr class="odd">
<td align="right">-0.2764722</td>
<td align="right">-0.1896666</td>
<td align="right">-0.1649317</td>
</tr>
<tr class="even">
<td align="right">0.3712718</td>
<td align="right">0.5481408</td>
<td align="right">0.6233055</td>
</tr>
</tbody>
</table>
<p>How much have we improved on the average variance for all blocks in this case?</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(<span class="fu">apply</span>(diff_initial, <span class="dv">1</span>, var)))   </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4275037</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(<span class="fu">apply</span>(diff_final, <span class="dv">1</span>, var)))     </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.04305659</span></span></code></pre></div>
<p>We also list IIAs for demonstration purposes, which also improves.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(<span class="fu">get_iia</span>(result<span class="sc">$</span>block_final, <span class="at">data =</span> item_responses))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      BPlin     BPquad      AClin     ACquad </span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.0195425 -0.0498910  0.1263995  0.1595815</span></span></code></pre></div>
</div>
<div id="step-6-automatic-pairing-with-a-multi-step-optimization-process" class="section level3">
<h3>Step 6: Automatic pairing with a multi-step optimization process</h3>
<p>In some cases, users may want to optimize item characteristics sequentially, rather than in a simultaneous manner. This makes sense because it is possible that simultaneous optimization will inevitably favor the improvement in one characteristic at the cost of losing the best fit for the other, as we have observed in Step 5.</p>
<p>Two solutions can be made to address this problem:</p>
<ol style="list-style-type: decimal">
<li><p>Pay careful attention to the distribution of each item characteristic and try out different weights for characteristics with different scales. Alternatively, try smaller <code>end_criteria</code> or larger <code>r</code> and <code>n_exchange</code> values to allow for more iterations to be run;</p></li>
<li><p>Use a multi-step optimization process, where some item characteristics are optimized first, then others. This involves running <code>sa_pairing_generalized()</code> several times, which each time optimizing more and more item characteristics. Those characteristics optimized will remain their weight in later stages, but have 0 weights if they are not yet optimized.</p></li>
</ol>
<p>With the previous example, we show how method 2 will work, starting from <code>initial_FC</code>. First we perform optimization on latent traits:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>FC_1 <span class="ot">&lt;-</span> <span class="fu">sa_pairing_generalized</span>(initial_FC, <span class="at">eta_Temperature =</span> <span class="fl">0.01</span>,</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">r =</span> <span class="fl">0.995</span>, <span class="at">end_criteria =</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>), </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">weights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">item_chars =</span> item_chars, <span class="at">use_IIA =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">rater_chars =</span> item_responses)</span></code></pre></div>
<p>Then, we optimize based on minimizing variance in social desirability within a block.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>FC_2 <span class="ot">&lt;-</span> <span class="fu">sa_pairing_generalized</span>(FC_1<span class="sc">$</span>block_final, <span class="at">eta_Temperature =</span> <span class="fl">0.01</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">r =</span> <span class="fl">0.995</span>, <span class="at">end_criteria =</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>), </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">weights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">item_chars =</span> item_chars, <span class="at">use_IIA =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rater_chars =</span> item_responses)</span></code></pre></div>
<p>Finally, we optimize bease on minimizing variance in item difficulty.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>FC_3 <span class="ot">&lt;-</span> <span class="fu">sa_pairing_generalized</span>(FC_2<span class="sc">$</span>block_final, <span class="at">eta_Temperature =</span> <span class="fl">0.01</span>,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">r =</span> <span class="fl">0.995</span>, <span class="at">end_criteria =</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">6</span>), </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">weights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span><span class="dv">3</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">item_chars =</span> item_chars, <span class="at">use_IIA =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">rater_chars =</span> item_responses)</span></code></pre></div>
</div>
<div id="step-7-see-how-a-multi-step-iteration-improves" class="section level3">
<h3>Step 7: See how a multi-step iteration improves</h3>
<p>First, underlying latent traits. It does look nice like what we have in Step 5.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">matrix</span>(item_chars<span class="sc">$</span>DIM[<span class="fu">t</span>(FC_3<span class="sc">$</span>block_final)], <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="left">Extraversion</td>
<td align="left">Openness</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Agreeableness</td>
<td align="left">Extraversion</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="odd">
<td align="left">Conscientiousness</td>
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
</tr>
<tr class="even">
<td align="left">Extraversion</td>
<td align="left">Openness</td>
<td align="left">Conscientiousness</td>
</tr>
<tr class="odd">
<td align="left">Agreeableness</td>
<td align="left">Openness</td>
<td align="left">Extraversion</td>
</tr>
<tr class="even">
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
<td align="left">Conscientiousness</td>
</tr>
<tr class="odd">
<td align="left">Neuroticism</td>
<td align="left">Agreeableness</td>
<td align="left">Extraversion</td>
</tr>
<tr class="even">
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
<td align="left">Extraversion</td>
</tr>
<tr class="odd">
<td align="left">Openness</td>
<td align="left">Neuroticism</td>
<td align="left">Extraversion</td>
</tr>
<tr class="even">
<td align="left">Openness</td>
<td align="left">Neuroticism</td>
<td align="left">Conscientiousness</td>
</tr>
<tr class="odd">
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
<td align="left">Agreeableness</td>
</tr>
<tr class="even">
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
<td align="left">Conscientiousness</td>
</tr>
<tr class="odd">
<td align="left">Conscientiousness</td>
<td align="left">Extraversion</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="even">
<td align="left">Conscientiousness</td>
<td align="left">Neuroticism</td>
<td align="left">Openness</td>
</tr>
<tr class="odd">
<td align="left">Extraversion</td>
<td align="left">Conscientiousness</td>
<td align="left">Openness</td>
</tr>
<tr class="even">
<td align="left">Extraversion</td>
<td align="left">Agreeableness</td>
<td align="left">Neuroticism</td>
</tr>
<tr class="odd">
<td align="left">Conscientiousness</td>
<td align="left">Conscientiousness</td>
<td align="left">Openness</td>
</tr>
<tr class="even">
<td align="left">Conscientiousness</td>
<td align="left">Openness</td>
<td align="left">Extraversion</td>
</tr>
<tr class="odd">
<td align="left">Openness</td>
<td align="left">Neuroticism</td>
<td align="left">Extraversion</td>
</tr>
<tr class="even">
<td align="left">Conscientiousness</td>
<td align="left">Neuroticism</td>
<td align="left">Extraversion</td>
</tr>
</tbody>
</table>
<p>Next let’s look at difference in social desirability within each block. It performs better than in Step 5, where the discrepancy within block is removed!</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sd_FC3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(item_chars<span class="sc">$</span>SD_Mean[<span class="fu">t</span>(FC_3<span class="sc">$</span>block_final)], <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(sd_FC3)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">2.430</td>
<td align="right">2.408</td>
<td align="right">2.257</td>
</tr>
<tr class="even">
<td align="right">2.299</td>
<td align="right">2.371</td>
<td align="right">2.283</td>
</tr>
<tr class="odd">
<td align="right">3.429</td>
<td align="right">3.478</td>
<td align="right">3.549</td>
</tr>
<tr class="even">
<td align="right">2.291</td>
<td align="right">2.383</td>
<td align="right">2.296</td>
</tr>
<tr class="odd">
<td align="right">2.275</td>
<td align="right">2.331</td>
<td align="right">2.383</td>
</tr>
<tr class="even">
<td align="right">3.458</td>
<td align="right">3.484</td>
<td align="right">3.549</td>
</tr>
<tr class="odd">
<td align="right">2.367</td>
<td align="right">2.410</td>
<td align="right">2.375</td>
</tr>
<tr class="even">
<td align="right">3.501</td>
<td align="right">3.470</td>
<td align="right">3.469</td>
</tr>
<tr class="odd">
<td align="right">2.326</td>
<td align="right">2.346</td>
<td align="right">2.367</td>
</tr>
<tr class="even">
<td align="right">3.518</td>
<td align="right">3.499</td>
<td align="right">3.526</td>
</tr>
<tr class="odd">
<td align="right">3.493</td>
<td align="right">3.455</td>
<td align="right">3.449</td>
</tr>
<tr class="even">
<td align="right">3.429</td>
<td align="right">3.474</td>
<td align="right">3.575</td>
</tr>
<tr class="odd">
<td align="right">3.540</td>
<td align="right">3.501</td>
<td align="right">3.515</td>
</tr>
<tr class="even">
<td align="right">3.418</td>
<td align="right">3.628</td>
<td align="right">3.417</td>
</tr>
<tr class="odd">
<td align="right">2.294</td>
<td align="right">2.354</td>
<td align="right">2.381</td>
</tr>
<tr class="even">
<td align="right">2.269</td>
<td align="right">2.275</td>
<td align="right">2.314</td>
</tr>
<tr class="odd">
<td align="right">3.521</td>
<td align="right">3.476</td>
<td align="right">3.551</td>
</tr>
<tr class="even">
<td align="right">2.386</td>
<td align="right">2.344</td>
<td align="right">2.382</td>
</tr>
<tr class="odd">
<td align="right">3.492</td>
<td align="right">3.524</td>
<td align="right">3.481</td>
</tr>
<tr class="even">
<td align="right">2.327</td>
<td align="right">2.306</td>
<td align="right">2.372</td>
</tr>
</tbody>
</table>
<p>As before, let’s see how much have we improved on the average variance for all blocks. Improvement in social desirability is verified by seeing the decrease in variance.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial solution</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(<span class="fu">apply</span>(sd_initial, <span class="dv">1</span>, var)))   </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.3317092</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simultaneous optimization</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(<span class="fu">apply</span>(sd_final, <span class="dv">1</span>, var)))    </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.04195382</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequential optimization</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(<span class="fu">apply</span>(sd_FC3, <span class="dv">1</span>, var)))       </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.002573133</span></span></code></pre></div>
<p>Finally we look at item difficulty.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>diff_fc3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(item_chars<span class="sc">$</span>DIF[<span class="fu">t</span>(FC_3<span class="sc">$</span>block_final)], <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(diff_final)</span></code></pre></div>
<table>
<tbody>
<tr class="odd">
<td align="right">-0.7635046</td>
<td align="right">-0.0490111</td>
<td align="right">-0.5168748</td>
</tr>
<tr class="even">
<td align="right">-0.6267511</td>
<td align="right">-0.9898177</td>
<td align="right">-0.4484543</td>
</tr>
<tr class="odd">
<td align="right">0.9447096</td>
<td align="right">0.5910397</td>
<td align="right">0.6105311</td>
</tr>
<tr class="even">
<td align="right">0.2507761</td>
<td align="right">0.2383125</td>
<td align="right">0.4304538</td>
</tr>
<tr class="odd">
<td align="right">0.3665809</td>
<td align="right">0.3986206</td>
<td align="right">0.3189794</td>
</tr>
<tr class="even">
<td align="right">0.6598719</td>
<td align="right">0.5768038</td>
<td align="right">0.1906729</td>
</tr>
<tr class="odd">
<td align="right">-0.9688906</td>
<td align="right">-0.7874764</td>
<td align="right">-0.7614264</td>
</tr>
<tr class="even">
<td align="right">0.8602120</td>
<td align="right">0.9388348</td>
<td align="right">0.9814553</td>
</tr>
<tr class="odd">
<td align="right">-0.0951617</td>
<td align="right">-0.5887666</td>
<td align="right">-0.2743858</td>
</tr>
<tr class="even">
<td align="right">0.8782261</td>
<td align="right">0.7562551</td>
<td align="right">0.9194196</td>
</tr>
<tr class="odd">
<td align="right">0.8652686</td>
<td align="right">0.9139843</td>
<td align="right">0.8647261</td>
</tr>
<tr class="even">
<td align="right">-0.0455446</td>
<td align="right">-0.7846000</td>
<td align="right">-0.1734361</td>
</tr>
<tr class="odd">
<td align="right">-0.1775934</td>
<td align="right">-0.3477869</td>
<td align="right">-0.1609612</td>
</tr>
<tr class="even">
<td align="right">0.4033506</td>
<td align="right">0.3847467</td>
<td align="right">0.0105288</td>
</tr>
<tr class="odd">
<td align="right">-0.1072381</td>
<td align="right">0.0917744</td>
<td align="right">0.2106074</td>
</tr>
<tr class="even">
<td align="right">-0.7339903</td>
<td align="right">-0.8802425</td>
<td align="right">-0.8770999</td>
</tr>
<tr class="odd">
<td align="right">0.5814682</td>
<td align="right">0.7372855</td>
<td align="right">0.7113918</td>
</tr>
<tr class="even">
<td align="right">-0.4487723</td>
<td align="right">-0.1364442</td>
<td align="right">0.3800486</td>
</tr>
<tr class="odd">
<td align="right">-0.2764722</td>
<td align="right">-0.1896666</td>
<td align="right">-0.1649317</td>
</tr>
<tr class="even">
<td align="right">0.3712718</td>
<td align="right">0.5481408</td>
<td align="right">0.6233055</td>
</tr>
</tbody>
</table>
<p>Average variance of item difficulty also decreases!</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initial solution</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(<span class="fu">apply</span>(diff_initial, <span class="dv">1</span>, var))) </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.4275037</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Simultaneous optimization</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(<span class="fu">apply</span>(diff_final, <span class="dv">1</span>, var)))   </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.04305659</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequential optimization</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(<span class="fu">apply</span>(diff_fc3, <span class="dv">1</span>, var)))      </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.04012038</span></span></code></pre></div>
<p>How about IIAs?</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colMeans</span>(<span class="fu">get_iia</span>(FC_3<span class="sc">$</span>block_final, <span class="at">data =</span> item_responses))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      BPlin     BPquad      AClin     ACquad </span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  0.0335635 -0.0304330  0.1459820  0.1892760</span></span></code></pre></div>
</div>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>In this tutorial, we have shown how the functionality of <code>autoFC</code> can be used to automatically build forced choice scales with better matches in various item characteristics.</p>
<p>We note that this automatic tool does not guarantee the production of a scale with best matches in these characteristic simultaneously, but instead provides solutions close to optimal among a search space where exhaustive enumeration of each solution is unrealistic.</p>
<ul>
<li>To further illustrate this, consider when constructing an FC scale consisting of 20 triplets with 60 items, the number of possible scales is <span class="math inline">\(\frac{C^3_{60} * C^3_{57} * ...... }{20!} = \frac{60!}{6^{20}\times20!} = 9.35\times10^{47}\)</span>.</li>
</ul>
<p>We also note that, to produce scales with better overall fit, users are encouraged to: 1. customize their own functions for optimizing each item characteristic; 2. Try out different <code>weights</code>, <code>iia_weights</code>, <code>Temperature (eta_Temperature)</code> or <code>r</code> values; 3. Use a sequential process to optimize item characteristics one by one.</p>
<p>Good luck!</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
